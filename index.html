ðŸŒŸCE SITE EST EN PLEINE CRÃ‰ATIONðŸŒŸ
<!DOCTYPE html>
<html lang="fr" translate="no">
<head>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0HC6CY42YB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-0HC6CY42YB');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LATYFA BOUTIQUE | Officiel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,900;1,900&family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { 
            --latyfa-gold: #c5a059;   
            --latyfa-dark: #1a1a1a;   
            --latyfa-accent: #ff6600; 
        }
        
        body { 
            background-color: #fcfcfc; 
            font-family: 'Montserrat', sans-serif; 
            margin: 0; 
            scroll-behavior: smooth; 
            transition: background-color 0.5s ease, color 0.5s ease;
        }
        
        .logo-font { font-family: 'Playfair Display', serif; color: var(--latyfa-gold) !important; }
        .text-latyfa-gold { color: var(--latyfa-gold) !important; }
        .bg-latyfa-gold { background-color: var(--latyfa-gold) !important; }
        
        .category-link {
            font-family: 'Montserrat', sans-serif;
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 0.1em;
            color: #555;
            transition: all 0.3s ease;
            border-bottom: 1px solid #f0f0f0;
            padding-bottom: 8px;
        }
        
        .category-link:hover {
            color: var(--latyfa-gold);
            padding-left: 5px;
            border-bottom-color: var(--latyfa-gold);
        }
        
        .product-card { 
            background: white; 
            border-radius: 8px; 
            border: 1px solid transparent; 
            height: 100%; 
            display: flex; 
            flex-direction: column; 
            cursor: pointer; 
            transition: 0.2s; 
        }
        
        .product-card:hover { 
            border-color: var(--latyfa-gold); 
            box-shadow: 0 4px 12px rgba(0,0,0,0.1); 
        }
        
        .modal { 
            display: none; 
            position: fixed; 
            z-index: 1000; 
            left: 0; 
            top: 0; 
            width: 100%; 
            height: 100%; 
            background: white; 
            overflow-y: auto; 
            padding: 20px; 
        }
        
        .modal.active { 
            display: block; 
        }
        
        .wheel-mask { 
            display: none; 
            position: fixed; 
            inset: 0; 
            background: rgba(0,0,0,0.9); 
            z-index: 2000; 
            align-items: center; 
            justify-content: center; 
            backdrop-filter: blur(8px); 
        }
        
        .wheel-mask.active { 
            display: flex; 
        }
        
        .wheel-box { 
            background: white; 
            padding: 30px; 
            border-radius: 30px; 
            text-align: center; 
            position: relative; 
            width: 95%; 
            max-width: 400px; 
            border: 5px solid var(--latyfa-gold); 
        }
        
        #canvas { 
            width: 280px; 
            height: 280px; 
            transition: transform 4s cubic-bezier(0.15, 0, 0.15, 1); 
            margin: 20px auto; 
        }
        
        @keyframes loading {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .loader-hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        @keyframes marquee {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }
        
        .animate-marquee {
            display: inline-block;
            padding-left: 100%;
            animation: marquee 25s linear infinite;
        }
        
        .animate-marquee:hover {
            animation-play-state: paused;
        }
        
        .no-scrollbar::-webkit-scrollbar { 
            display: none; 
        }
        
        .thumb-active {
            border-color: var(--latyfa-gold) !important;
            transform: scale(1.05);
        }
        
        body.dark-theme {
            background-color: #121212 !important;
            color: #e0e0e0;
        }
        
        .dark-theme header, 
        .dark-theme aside, 
        .dark-theme .product-card,
        .dark-theme .modal > div {
            background-color: #1e1e1e !important;
            border-color: #333 !important;
        }
    </style>
    
    <audio id="wheel-sound" src="https://assets.mixkit.co/active_storage/sfx/483/483-preview.mp3" preload="auto"></audio>
    <audio id="cart-sound" src="https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3" preload="auto"></audio>
</head>
<body>

<div id="loader" class="fixed inset-0 bg-[#1a1a1a] z-[3000] flex flex-col items-center justify-center transition-opacity duration-700">
    <div class="relative">
        <img src="https://i.postimg.cc/qMqtFGM2/1770342273452.png" class="h-24 w-24 rounded-full border-2 border-[#c5a059] animate-pulse shadow-[0_0_20px_rgba(197,160,89,0.3)]">
    </div>
    <div class="mt-6 flex flex-col items-center">
        <span class="logo-font text-2xl text-[#c5a059] italic tracking-tighter">LATYFA SHOP</span>
        <div class="w-32 h-[1px] bg-gray-800 mt-3 relative overflow-hidden">
            <div class="absolute inset-0 bg-[#c5a059] animate-[loading_1.5s_ease-in-out_infinite]"></div>
        </div>
    </div>
</div>

<div id="toast" class="fixed top-20 left-1/2 -translate-x-1/2 bg-black/90 text-[#c5a059] px-6 py-3 rounded-full text-[10px] font-bold uppercase tracking-widest z-[2000] opacity-0 transition-opacity duration-300 pointer-events-none">
    âœ¨ Produit ajoutÃ© au panier
</div>

<div class="bg-[#1a1a1a] text-[#c5a059] text-center py-2.5 text-[10px] font-bold border-b border-[#c5a059]/30 tracking-[0.15em] uppercase">
    âœ¨ Promo Exclusive -20% dÃ¨s 20.000 F D'achat Ã  partir du 14 fÃ©v au 28 fÃ©v 2026: <span id="countdown" class="text-white ml-1">--:--:--</span> âœ¨
</div>

<div class="bg-white border-b border-gray-100 py-1 overflow-hidden whitespace-nowrap">
    <div class="inline-block animate-marquee text-[9px] font-bold uppercase tracking-[0.2em] text-gray-400">
        âœ¨ LIVRAISON GRATUITE SUR COCODY CE WEEK-END ! â€” ðŸ’Ž NOUVELLE COLLECTION DE BIJOUX DISPONIBLE â€” ðŸšš EXPÃ‰DITION SOUS 48H DANS TOUTE LA CÃ”TE D'IVOIRE â€” âœ¨ LIVRAISON GRATUITE SUR COCODY CE WEEK-END ! â€” ðŸ’Ž NOUVELLE COLLECTION DE BIJOUX DISPONIBLE â€”
    </div>
</div>

<header class="bg-white shadow-sm sticky top-0 z-50">
    <div class="container mx-auto px-4 py-3 flex items-center justify-between gap-4">
        <div class="flex items-center gap-2">
            <img src="https://i.postimg.cc/qMqtFGM2/1770342273452.png" class="h-10 w-10 rounded-full border border-gray-200">
            <span class="text-2xl font-black italic logo-font text-[#c5a059] tracking-tighter">LATYFA SHOP</span>
        </div>
        <div class="flex-1 max-w-md hidden md:block">
            <div class="relative">
                <input type="text" id="search-input" oninput="rechercherProduit()" placeholder="Rechercher un article..." 
                       class="w-full bg-gray-100 border-none rounded-full py-2 px-10 text-xs focus:ring-2 focus:ring-[#c5a059] outline-none">
                <i class="fa-solid fa-magnifying-glass absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 text-xs"></i>
            </div>
        </div>
        <div class="flex gap-6">
            <button onclick="toggleDarkMode()" class="h-8 w-8 rounded-full bg-gray-100 flex items-center justify-center text-gray-600 hover:bg-black hover:text-white transition-all ml-2" id="dark-mode-btn">
                <i class="fa-solid fa-moon"></i>
            </button>
            <div onclick="suivreColis()" class="text-center cursor-pointer hover:text-[#ff6600]">
                <i class="fa-solid fa-truck text-gray-600"></i>
                <p class="text-[9px] font-bold uppercase">Suivi</p>
            </div>
            <div onclick="ouvrirPanier()" class="text-center cursor-pointer relative hover:text-[#ff6600]">
                <i class="fa-solid fa-cart-shopping text-gray-600"></i>
                <span id="cart-count" class="absolute -top-2 -right-2 bg-[#ff6600] text-white text-[10px] rounded-full px-1.5 font-bold">0</span>
                <p class="text-[9px] font-bold uppercase">Panier</p>
            </div>
        </div>
    </div>
</header>

<section class="relative w-full h-[350px] md:h-[500px] bg-black overflow-hidden">
    <img src="https://images.unsplash.com/photo-1441986300917-64674bd600d8?w=1200" class="w-full h-full object-cover opacity-70">
    <div class="absolute inset-0 flex flex-col items-center justify-center text-center px-6">
        <h1 class="text-white text-4xl md:text-6xl font-black italic uppercase tracking-tighter leading-none">La Boutique du 225</h1>
        <p class="text-orange-400 font-bold mt-3 uppercase text-xs md:text-sm tracking-[0.2em]">Bijoux, vÃªtements, parfum...</p>
        <a href="#collection" class="mt-8 bg-[#ff6600] text-white px-10 py-4 rounded-full font-black text-xs uppercase hover:scale-105 transition shadow-lg">DÃ©couvrir la Collection</a>
    </div>
</section>

<div id="collection" class="container mx-auto px-4 py-12 flex flex-col md:flex-row gap-8">
    <aside class="w-full md:w-64 bg-white rounded-xl p-6 shadow-sm h-fit md:sticky md:top-24 border border-gray-100">
        <h3 class="logo-font font-black border-b-2 border-[#c5a059] pb-3 mb-6 text-[13px] uppercase text-[#1a1a1a] tracking-widest text-center">
            Nos Univers
        </h3>
        <div class="flex flex-col gap-5" id="categories-container">
            <!-- Les catÃ©gories seront insÃ©rÃ©es ici par JavaScript -->
        </div>
    </aside>
    
    <main class="flex-1">
        <div class="grid grid-cols-2 lg:grid-cols-3 gap-6" id="product-grid"></div>
    </main>
</div>

<button onclick="document.querySelector('.wheel-mask').classList.add('active')" class="fixed bottom-24 right-6 h-14 w-14 bg-black text-white rounded-full shadow-2xl z-40 animate-bounce flex items-center justify-center border-2 border-[#c5a059]">
    <i class="fa-solid fa-gift text-[#c5a059] text-2xl"></i>
</button>

<div class="wheel-mask">
    <div class="wheel-box">
        <button onclick="document.querySelector('.wheel-mask').classList.remove('active')" class="absolute top-4 right-4 text-gray-900 font-black text-xl">Ã—</button>
        <h3 class="logo-font text-xl font-black italic uppercase text-gray-800">LATYFA LUCKY WHEEL</h3>
        <p id="wheel-msg" class="text-[11px] font-black uppercase mt-2 text-blue-600"></p>
        <div class="relative">
            <canvas id="canvas" width="300" height="300"></canvas>
            <div class="absolute top-0 left-1/2 -translate-x-1/2 -mt-4 text-3xl text-[#c5a059]">â–¼</div>
        </div>
        <button id="spin" class="bg-black text-white py-4 px-8 rounded-full font-black uppercase text-sm w-full mt-4 hover:bg-gray-800 transition">TENTER MA CHANCE</button>
    </div>
</div>

<div id="productDetailModal" class="modal">
    <div class="max-w-2xl mx-auto">
        <button onclick="document.getElementById('productDetailModal').classList.remove('active')" class="mb-6 text-gray-500 font-bold uppercase text-[10px]"><i class="fa-solid fa-arrow-left"></i> Retour</button>
        <div class="flex flex-col md:flex-row gap-8">
            <div class="md:w-1/2">
                <img id="main-detail-img" src="" class="w-full h-80 object-cover rounded-xl shadow-md border">
                <div id="thumbnails" class="flex gap-2 mt-4 overflow-x-auto no-scrollbar"></div>
            </div>
            <div class="md:w-1/2">
                <h2 id="detail-name" class="text-2xl font-black uppercase italic text-gray-800"></h2>
                <p id="detail-price" class="text-[#ff6600] font-black text-2xl mt-2"></p>
                <div class="my-4 border-t pt-4"><p id="detail-desc" class="text-xs text-gray-600 leading-relaxed"></p></div>
                <div class="space-y-4 my-6">
                    <div id="size-area" class="block"> 
                        <label class="block text-[10px] font-black uppercase text-gray-400 mb-2">Taille / Pointure</label>
                        <select id="select-size" class="w-full p-3 border rounded-xl bg-gray-50 text-sm font-bold outline-none focus:ring-2 focus:ring-black"></select>
                    </div>
                    <div id="color-area" class="hidden">
                        <label class="text-[10px] font-black uppercase text-gray-400">Couleur</label>
                        <select id="select-color" class="w-full border p-3 rounded-lg mt-1 text-sm bg-gray-50"></select>
                    </div>
                </div>
                <button onclick="ajouterDepuisDetail()" class="w-full bg-[#c5a059] text-white py-4 rounded-xl font-black uppercase text-[11px] shadow-lg mb-6">Ajouter au panier</button>
            </div>
        </div>
    </div>
</div>

<div id="cartModal" class="modal bg-black/40 backdrop-blur-sm">
    <div class="max-w-md mx-auto bg-white rounded-t-3xl p-6 min-h-[85vh] mt-10 shadow-2xl relative">
        <div class="flex justify-between items-center mb-6 border-b pb-4">
            <h2 class="text-lg font-black uppercase italic tracking-widest text-[#c5a059]">Mon Panier</h2>
            <button onclick="viderPanier()" class="text-[9px] font-bold text-red-500 uppercase border border-red-100 px-3 py-1 rounded-full hover:bg-red-50">
                <i class="fa-solid fa-trash-can mr-1"></i> Vider
            </button>
        </div>
        <div id="cart-items" class="space-y-4 mb-6 max-h-[30vh] overflow-y-auto no-scrollbar"></div>
        <div id="checkout-form" style="display:none;" class="space-y-4 border-t pt-4">
            <div class="flex gap-2 bg-gray-50 p-2 rounded-xl">
                <input type="text" id="input-promo" placeholder="CODE PROMO" class="flex-1 border-none bg-transparent p-2 text-sm uppercase font-bold focus:ring-0">
                <button onclick="appliquerPromo()" class="bg-black text-white px-6 rounded-lg text-[10px] font-bold hover:bg-[#c5a059] transition-colors">OK</button>
            </div>
            <input type="text" id="nom-client" placeholder="NOM COMPLET *" class="w-full border p-3 rounded-lg text-sm uppercase bg-gray-50 focus:border-[#c5a059] outline-none">
            <div class="grid grid-cols-2 gap-2">
                <input type="tel" id="tel-client" placeholder="WHATSAPP *" class="w-full border p-3 rounded-lg text-sm bg-gray-50 focus:border-[#c5a059] outline-none">
                <input type="text" id="quartier-client" placeholder="QUARTIER *" class="w-full border p-3 rounded-lg text-sm bg-gray-50 focus:border-[#c5a059] outline-none">
            </div>
            <select id="zone-livraison" onchange="majResume()" class="w-full border p-3 rounded-lg text-sm font-bold bg-blue-50 border-blue-200 outline-none">
                <option value="">-- CHOISIR ZONE LIVRAISON --</option>
                <option value="abidjan_nord">Abidjan Nord (1.500 F)</option>
                <option value="abidjan_sud">Abidjan Sud (2.000 F)</option>
                <option value="interieur">IntÃ©rieur pays (3.000 F)</option>
                <option value="bouake">Retrait Boutique (Gratuit)</option>
            </select>
            <div class="bg-gray-50 p-4 rounded-xl space-y-2 border border-gray-100">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-2">
                        <i class="fa-solid fa-gift text-pink-500"></i>
                        <span class="text-[9px] font-black uppercase">Emballage Cadeau (+1.000 F)</span>
                    </div>
                    <input type="checkbox" id="check-cadeau" onchange="majResume()" class="h-4 w-4 accent-pink-500">
                </div>
                <div id="resume-final" class="text-[10px] font-bold uppercase space-y-1 text-gray-600"></div>
            </div>
            <div class="text-xl font-black flex justify-between items-center p-3 bg-white border-2 border-black rounded-xl">
                <span>TOTAL :</span>
                <span id="total-display" class="text-red-600">0 F</span>
            </div>
            <div class="flex items-start gap-2 py-2">
                <input type="checkbox" id="check-verif" onchange="toggleBouton()" class="mt-1 h-4 w-4 accent-black">
                <label for="check-verif" class="text-[8px] font-bold uppercase text-gray-500 leading-tight">
                    Je confirme ma commande et j'accepte les conditions de vente de Latyfa Shop.
                </label>
            </div>
            <button id="btn-final" onclick="validerCommande()" class="w-full bg-gray-300 text-white py-4 rounded-full font-black uppercase shadow-xl pointer-events-none transition-all duration-300" disabled>
                <i class="fa-brands fa-whatsapp mr-2"></i> Commander via WhatsApp
            </button>
        </div>
        <button onclick="document.getElementById('cartModal').classList.remove('active')" class="w-full mt-6 text-[10px] font-bold uppercase text-gray-400 hover:text-black transition-colors underline">
            Continuer mes achats
        </button>
    </div>
</div>

<div id="cgvModal" class="modal bg-gray-100">
    <div class="max-w-2xl mx-auto bg-white p-8 rounded-2xl shadow-2xl my-6 border border-gray-200">
        <div class="flex justify-between items-center border-b pb-4 mb-6">
            <h2 class="text-xl font-black uppercase text-gray-800 italic">Conditions GÃ©nÃ©rales de Vente</h2>
            <button onclick="document.getElementById('cgvModal').classList.remove('active')" class="text-2xl font-bold">&times;</button>
        </div>
        <div class="text-[11px] space-y-6 text-gray-700 leading-relaxed overflow-y-auto max-h-[60vh] pr-2 uppercase font-semibold">
            <section>
                <h3 class="text-[#ff6600] font-black mb-2">1. OBJET ET ACCEPTATION</h3>
                <p>Les prÃ©sentes conditions rÃ©gissent les ventes de la boutique LATYFA BOUTIQUE. Toute validation de commande sur WhatsApp aprÃ¨s consultation du site implique l'adhÃ©sion totale Ã  ces conditions.</p>
            </section>
            <section>
                <h3 class="text-[#ff6600] font-black mb-2">2. PRIX ET PAIEMENT</h3>
                <p>Les prix sont indiquÃ©s en FCFA. Le paiement est exigible en totalitÃ© au moment de la commande via Mobile Money (Wave, Orange Money, MTN).</p>
            </section>
        </div>
        <button onclick="document.getElementById('cgvModal').classList.remove('active')" class="w-full mt-8 bg-[#c5a059] text-white py-4 rounded-xl font-black text-xs uppercase shadow-md">J'ai compris et j'accepte</button>
    </div>
</div>

<div onclick="ouvrirAdmin()" class="fixed bottom-2 left-2 w-10 h-10 cursor-pointer z-[100] opacity-0 hover:opacity-20 flex items-center justify-center text-[10px] text-gray-400">ADM</div>

<div id="adminModal" class="modal bg-gray-50">
    <div class="max-w-xl mx-auto pb-20">
        <div class="flex justify-between items-center mb-8 sticky top-0 bg-gray-50 py-4 z-10">
            <h2 class="text-2xl font-black uppercase italic">Gestion Boutique</h2>
            <button onclick="document.getElementById('adminModal').classList.remove('active')" class="text-gray-400 text-2xl">&times;</button>
        </div>
        <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-200 mb-8">
            <h3 class="text-[10px] font-black uppercase tracking-widest text-[#c5a059] mb-4">Ajouter un nouvel article</h3>
            <div class="grid grid-cols-1 gap-4">
                <input type="text" id="adm-name" placeholder="Nom du produit *" class="w-full border p-3 rounded-lg text-sm">
                <input type="number" id="adm-price" placeholder="Prix (ex: 15000) *" class="w-full border p-3 rounded-lg text-sm">
                <select id="adm-cat" class="w-full border p-3 rounded-lg text-sm">
                    <option value="bijoux">Bijoux</option>
                    <option value="vetements">VÃªtements</option>
                    <option value="chaussures">Chaussures</option>
                    <option value="sac">Sacs</option>
                    <option value="parfum">Parfums</option>
                    <option value="hanche">Perles de hanche</option>
                    <option value="autres">Autres</option>
                </select>
                <textarea id="adm-img" placeholder="Liens images (sÃ©parÃ©s par des virgules)" class="w-full border p-3 rounded-lg text-sm h-20"></textarea>
                <textarea id="adm-desc" placeholder="Description courte" class="w-full border p-3 rounded-lg text-sm h-20"></textarea>
                <button onclick="ajouterProduitAdmin()" class="bg-black text-white py-4 rounded-xl font-black uppercase text-xs hover:bg-gray-800 transition">Mettre en ligne</button>
            </div>
        </div>
        <h3 class="text-[10px] font-black uppercase tracking-widest text-gray-400 mb-4">Articles en ligne</h3>
        <div id="admin-list" class="space-y-2 mb-10"></div>
    </div>
</div>

<script>
// --- VARIABLES GLOBALES ---
let products = [
    { id: 1, cat: "sac", name: "Sac Prestige Latyfa", price: 45000, images: ["https://images.unsplash.com/photo-1584917865442-de89df76afd3?w=500"], enStock: true, description: "Ã‰lÃ©gance Signature Latyfa. Cuir Premium finition luxe." },
    { id: 2, cat: "bijoux", name: "Collier Perle Royale", price: 25000, images: ["https://images.unsplash.com/photo-1515562141207-7a18b5ce7142?w=500"], enStock: true, description: "Finition Or 24K. Design exclusif." },
    { id: 3, cat: "hanche", name: "Baya Cristal Ã‰clat", price: 5000, images: ["https://images.unsplash.com/photo-1611085583191-a3b130944362?w=500"], enStock: true, description: "Perles de hanche traditionnelles." },
    { id: 4, cat: "parfum", name: "Oud Mystique - 100ml", price: 35000, images: ["https://images.unsplash.com/photo-1541643600914-78b084683601?w=500"], enStock: true, description: "Fragrance envoÃ»tante." },
    { id: 5, cat: "chaussures", name: "Escarpins Gold Night", price: 28000, images: ["https://images.unsplash.com/photo-1543163521-1bf539c55dd2?w=500"], enStock: true, pointures: ["37", "38", "39", "40"], description: "Confort et prestige." }
];

let cart = JSON.parse(localStorage.getItem('latyfa_cart')) || [];
let currentProduct = null;
let remiseCodePromo = 0;

const tarifsLivraison = {
    "abidjan_nord": { nom: "Abidjan Nord", prix: 1500 },
    "abidjan_sud": { nom: "Abidjan Sud", prix: 2000 },
    "interieur": { nom: "IntÃ©rieur CI", prix: 3000 },
    "bouake": { nom: "Retrait Boutique", prix: 0 }
};

let categories = [
    { id: 'bijoux', nom: 'Bijoux', icone: 'fa-gem' },
    { id: 'vetements', nom: 'VÃªtements', icone: 'fa-shirt' },
    { id: 'chaussures', nom: 'Chaussures', icone: 'fa-shoe-prints' },
    { id: 'sac', nom: 'Sacs Ã  main', icone: 'fa-bag-shopping' },
    { id: 'parfum', nom: 'Parfums', icone: 'fa-spray-can-sparkles' },
    { id: 'hanche', nom: 'Perles de hanche', icone: 'fa-circle-nodes' },
    { id: 'autres', nom: 'Autres', icone: 'fa-plus' }
];

// --- FONCTIONS PRINCIPALES ---
function render(filter = 'tous') {
    const grid = document.getElementById('product-grid');
    if (!grid) return;
    
    grid.innerHTML = products.filter(p => filter === 'tous' || p.cat === filter).map(p => `
        <div class="product-card p-3 relative ${p.enStock === false ? 'opacity-75' : ''}" onclick="${p.enStock === false ? '' : 'voirDetails('+p.id+')'}">
            ${p.price > 30000 ? '<span class="absolute top-2 left-2 bg-black text-white text-[8px] px-2 py-1 rounded-full z-10 shadow-md">LUXE</span>' : ''}
            ${p.enStock === false ? '<span class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-red-600 text-white text-[10px] font-black px-4 py-2 rounded-full z-20 rotate-[-15deg] shadow-xl border-2 border-white">SOLD OUT</span>' : ''}
            <img src="${p.images[0]}" class="h-44 w-full object-cover rounded mb-3 border ${p.enStock === false ? 'grayscale' : ''}">
            <h3 class="text-[11px] font-bold uppercase h-8 line-clamp-2 text-gray-800">${p.name}</h3>
            <div class="${p.enStock === false ? 'text-gray-400' : 'text-[#c5a059]'} font-black text-lg mt-2">${p.price.toLocaleString()} F</div>
            <div class="bg-gray-50 text-center py-2 mt-4 rounded text-[9px] font-bold uppercase tracking-widest border border-gray-100">
                ${p.enStock === false ? 'INDISPONIBLE' : 'Voir l\'article'}
            </div>
        </div>
    `).join('');
    
    updateCartCount();
}

function voirDetails(id) {
    const p = products.find(x => x.id === id);
    if (!p) return;
    currentProduct = p;
    
    document.getElementById('productDetailModal').classList.add('active');
    document.getElementById('detail-name').innerText = p.name;
    document.getElementById('detail-price').innerText = p.price.toLocaleString() + " F";
    document.getElementById('detail-desc').innerText = p.description;
    document.getElementById('main-detail-img').src = p.images[0];
    
    // Gestion des options
    const sizeArea = document.getElementById('size-area');
    const selectSize = document.getElementById('select-size');
    
    if (p.pointures && p.pointures.length > 0) {
        sizeArea.classList.remove('hidden');
        selectSize.innerHTML = p.pointures.map(s => `<option value="${s}">${s}</option>`).join('');
    } else {
        sizeArea.classList.add('hidden');
    }
}

function ajouterDepuisDetail() {
    if (!currentProduct) return;
    
    const size = document.getElementById('select-size').value || "";
    const label = `${currentProduct.name} ${size ? '('+size+')' : ''}`;
    
    const sound = document.getElementById('cart-sound');
    if(sound) sound.play().catch(e => console.log("Son bloquÃ©"));
    
    const index = cart.findIndex(x => x.label === label);
    if(index > -1) {
        cart[index].qty++;
    } else {
        cart.push({ 
            id: currentProduct.id, 
            label: label, 
            qty: 1, 
            price: currentProduct.price,
            images: currentProduct.images 
        });
    }
    
    updateCartCount();
    localStorage.setItem('latyfa_cart', JSON.stringify(cart));
    document.getElementById('productDetailModal').classList.remove('active');
    
    const toast = document.getElementById('toast');
    if(toast) {
        toast.classList.remove('opacity-0');
        setTimeout(() => toast.classList.add('opacity-0'), 2000);
    }
}

function updateCartCount() {
    const totalArticles = cart.reduce((sum, item) => sum + item.qty, 0);
    const badge = document.getElementById('cart-count');
    if(badge) {
        badge.innerText = totalArticles;
        badge.style.display = totalArticles > 0 ? 'flex' : 'none';
    }
}

function ouvrirPanier() {
    document.getElementById('cartModal').classList.add('active');
    const itemsDiv = document.getElementById('cart-items');
    const form = document.getElementById('checkout-form');
    
    if(cart.length === 0) { 
        itemsDiv.innerHTML = "<p class='text-center py-10 text-[10px] font-bold uppercase text-gray-400'>Panier Vide</p>"; 
        form.style.display = "none"; 
        return; 
    }
    
    form.style.display = "block";
    itemsDiv.innerHTML = cart.map(item => `
        <div class="flex justify-between items-center text-[10px] font-bold uppercase border-b pb-2">
            <div class="flex-1">${item.label}</div>
            <div class="flex gap-2 items-center">
                <button onclick="modifierQty('${item.label}',-1)" class="bg-gray-100 px-2 rounded">-</button>
                <span>${item.qty}</span>
                <button onclick="modifierQty('${item.label}',1)" class="bg-gray-100 px-2 rounded">+</button>
            </div>
        </div>
    `).join('');
    
    majResume();
}

function modifierQty(label, d) {
    const i = cart.find(x => x.label === label);
    if(i) { 
        i.qty += d; 
        if(i.qty < 1) cart = cart.filter(x => x.label !== label); 
    }
    updateCartCount();
    ouvrirPanier();
    localStorage.setItem('latyfa_cart', JSON.stringify(cart));
}

function viderPanier() {
    if (confirm("Voulez-vous vraiment vider votre panier ?")) {
        cart = [];
        localStorage.setItem('latyfa_cart', JSON.stringify(cart));
        updateCartCount();
        ouvrirPanier();
    }
}

function majResume() {
    const zoneKey = document.getElementById('zone-livraison').value;
    const isCadeau = document.getElementById('check-cadeau').checked;
    const containerResume = document.getElementById('resume-final');
    
    let totalArticles = cart.reduce((sum, item) => sum + (item.price * item.qty), 0);
    let fraisLivraison = zoneKey && tarifsLivraison[zoneKey] ? tarifsLivraison[zoneKey].prix : 0;
    let fraisCadeau = isCadeau ? 1000 : 0;
    let totalFinal = totalArticles + fraisLivraison + fraisCadeau;
    
    if(containerResume) {
        containerResume.innerHTML = `
            <div class="flex justify-between"><span>Articles:</span> <span>${totalArticles.toLocaleString()} F</span></div>
            ${fraisLivraison > 0 ? `<div class="flex justify-between"><span>Livraison:</span> <span>+${fraisLivraison.toLocaleString()} F</span></div>` : ''}
            ${fraisCadeau > 0 ? `<div class="flex justify-between text-pink-500"><span>Option Cadeau:</span> <span>+1.000 F</span></div>` : ''}
        `;
    }
    
    document.getElementById('total-display').innerText = totalFinal.toLocaleString() + " F";
    toggleBouton();
}

function toggleBouton() {
    const chk = document.getElementById('check-verif').checked;
    const nom = document.getElementById('nom-client').value.trim();
    const tel = document.getElementById('tel-client').value.trim();
    const zone = document.getElementById('zone-livraison').value;
    const btn = document.getElementById('btn-final');

    if (chk && nom !== "" && tel !== "" && zone !== "") {
        btn.classList.remove('bg-gray-300', 'pointer-events-none');
        btn.classList.add('bg-[#c5a059]', 'cursor-pointer');
        btn.disabled = false;
    } else {
        btn.classList.add('bg-gray-300', 'pointer-events-none');
        btn.classList.remove('bg-[#c5a059]', 'cursor-pointer');
        btn.disabled = true;
    }
}

function validerCommande() {
    const nom = document.getElementById('nom-client').value;
    const tel = document.getElementById('tel-client').value;
    const quartier = document.getElementById('quartier-client').value;
    const zone = document.getElementById('zone-livraison').value;
    const total = document.getElementById('total-display').innerText;

    if(!nom || !tel || !quartier || !zone) {
        alert("âš ï¸ Merci de remplir tous les champs obligatoires.");
        return;
    }

    let listWA = cart.map(i => `â€¢ ${i.label} (x${i.qty})`).join('\n');
    let msg = `âœ¨ *NOUVELLE COMMANDE - LATYFA SHOP*\n\n`;
    msg += `ðŸ‘¤ *CLIENT:* ${nom}\n`;
    msg += `ðŸ“ž *TEL:* ${tel}\n`;
    msg += `ðŸ“ *QUARTIER:* ${quartier}\n`;
    msg += `ðŸŒ *ZONE:* ${tarifsLivraison[zone].nom}\n\n`;
    msg += `ðŸ“ *ARTICLES:*\n${listWA}\n`;
    msg += `\nðŸ’° *TOTAL Ã€ PAYER: ${total}*`;

    window.open("https://wa.me/2250709002881?text=" + encodeURIComponent(msg));
}

function rechercherProduit() {
    const terme = document.getElementById('search-input').value.toLowerCase();
    const filtered = products.filter(p => p.name.toLowerCase().includes(terme));
    
    const grid = document.getElementById('product-grid');
    if (filtered.length === 0) {
        grid.innerHTML = `<div class="col-span-full text-center py-20 text-gray-500">Aucun rÃ©sultat</div>`;
    } else {
        grid.innerHTML = filtered.map(p => `
            <div class="product-card p-3" onclick="voirDetails(${p.id})">
                <img src="${p.images[0]}" class="h-44 w-full object-cover rounded mb-3">
                <h3 class="text-[11px] font-bold uppercase">${p.name}</h3>
                <div class="text-[#c5a059] font-black text-lg mt-2">${p.price.toLocaleString()} F</div>
            </div>
        `).join('');
    }
}

function suivreColis() { 
    alert("Si votre commande a Ã©tÃ© validÃ©e sur WhatsApp, vous serez contactÃ© !"); 
}

function toggleDarkMode() {
    document.body.classList.toggle('dark-theme');
    const btn = document.getElementById('dark-mode-btn');
    const icon = btn.querySelector('i');
    icon.classList.toggle('fa-moon');
    icon.classList.toggle('fa-sun');
}

// --- ADMIN ---
function ouvrirAdmin() {
    const codeAttendu = "2026";
    const codeSaisi = prompt("Veuillez entrer le code d'accÃ¨s :");
    if (codeSaisi === codeAttendu) {
        document.getElementById('adminModal').classList.add('active');
        refreshAdminList();
    } else if (codeSaisi !== null) {
        alert("âŒ Code incorrect.");
    }
}

function refreshAdminList() {
    const list = document.getElementById('admin-list');
    if (!list) return;
    
    list.innerHTML = products.map(p => `
        <div class="flex justify-between items-center bg-white p-3 rounded-xl border border-gray-100 mb-2 shadow-sm">
            <div class="flex items-center gap-3">
                <img src="${p.images[0]}" class="w-10 h-10 object-cover rounded-lg">
                <div>
                    <span class="font-black text-[10px] uppercase">${p.name}</span>
                    <span class="text-[10px] font-bold text-[#c5a059] block">${p.price.toLocaleString()} F</span>
                </div>
            </div>
            <div class="flex gap-1">
                <button onclick="toggleStock(${p.id})" class="text-[9px] font-black px-2 py-1 rounded-lg ${p.enStock ? 'bg-green-100 text-green-600' : 'bg-red-100 text-red-600'}">
                    ${p.enStock ? 'ON' : 'OFF'}
                </button>
                <button onclick="supprimerProduit(${p.id})" class="text-gray-300 hover:text-red-500 p-2">
                    <i class="fa-solid fa-trash-can text-[10px]"></i>
                </button>
            </div>
        </div>
    `).join('');
}

function ajouterProduitAdmin() {
    const name = document.getElementById('adm-name').value;
    const price = document.getElementById('adm-price').value;
    const cat = document.getElementById('adm-cat').value;
    const images = document.getElementById('adm-img').value.split(',').map(s => s.trim());
    const desc = document.getElementById('adm-desc').value;

    if(!name || !price || !images[0]) {
        alert("Remplissez les champs obligatoires !");
        return;
    }

    products.push({
        id: Date.now(),
        name: name,
        price: parseInt(price),
        cat: cat,
        images: images,
        description: desc || "Produit exclusif Latyfa",
        enStock: true
    });

    localStorage.setItem('latyfa_db', JSON.stringify(products));
    render();
    refreshAdminList();
    
    // Reset form
    document.getElementById('adm-name').value = '';
    document.getElementById('adm-price').value = '';
    document.getElementById('adm-img').value = '';
    document.getElementById('adm-desc').value = '';
    
    alert("Produit ajoutÃ© avec succÃ¨s !");
}

function supprimerProduit(id) {
    if(confirm("Supprimer dÃ©finitivement cet article ?")) {
        products = products.filter(p => p.id !== id);
        localStorage.setItem('latyfa_db', JSON.stringify(products));
        render();
        refreshAdminList();
    }
}

function toggleStock(id) {
    const p = products.find(x => x.id === id);
    if(p) {
        p.enStock = !p.enStock;
        localStorage.setItem('latyfa_db', JSON.stringify(p));
        render();
        refreshAdminList();
    }
}

// --- COMPTEUR ---
function updateVisitorCount() {
    let count = localStorage.getItem('latyfa_visitors') || 1250;
    count = parseInt(count) + 1;
    localStorage.setItem('latyfa_visitors', count);
    const visitorElement = document.getElementById('visitor-count');
    if(visitorElement) visitorElement.innerText = count.toLocaleString('fr-FR');
}

// --- COUNTDOWN ---
setInterval(() => {
    const diff = new Date("Feb 14, 2026 00:00:00").getTime() - new Date().getTime();
    if(diff <= 0) { 
        document.getElementById('countdown').innerText = "PROMO ACTIVÃ‰E !"; 
        return; 
    }
    const d = Math.floor(diff/86400000);
    const h = Math.floor((diff%86400000)/3600000);
    const m = Math.floor((diff%3600000)/60000);
    const s = Math.floor((diff%60000)/1000);
    document.getElementById('countdown').innerText = `${d}j ${h}h ${m}m ${s}s`;
}, 1000);

// --- ROUE DE LA FORTUNE ---
const prizes = ["-5%", "REESSAYER", "-10%", "CADEAU", "-15%", "REESSAYER", "LIVRAISON", "REESSAYER"];
const canvas = document.getElementById('canvas');
let ctx = canvas ? canvas.getContext('2d') : null;

function drawWheel() {
    if (!ctx) return;
    const arc = 2 * Math.PI / prizes.length;
    ctx.clearRect(0, 0, 300, 300);
    for (let i = 0; i < prizes.length; i++) {
        ctx.beginPath();
        ctx.fillStyle = i % 2 === 0 ? "#c5a059" : "#1a1a1a";
        ctx.moveTo(150, 150);
        ctx.arc(150, 150, 145, i * arc, (i + 1) * arc);
        ctx.fill();
        ctx.save();
        ctx.fillStyle = "white";
        ctx.translate(150, 150);
        ctx.rotate(i * arc + arc / 2);
        ctx.font = "bold 12px Montserrat";
        ctx.textAlign = "right";
        ctx.fillText(prizes[i], 130, 5);
        ctx.restore();
    }
}

function lancerRoue() {
    const btn = document.getElementById('spin');
    const wheel = document.getElementById('canvas');
    if (!btn || !wheel) return;

    btn.disabled = true;
    const randomRotation = Math.floor(Math.random() * 360) + 3600;
    wheel.style.transition = "transform 4s cubic-bezier(0.15, 0, 0.15, 1)";
    wheel.style.transform = `rotate(${randomRotation}deg)`;

    setTimeout(() => {
        btn.disabled = false;
        alert("ðŸŽ‰ FÃ©licitations ! VÃ©rifiez votre cadeau lors de la commande.");
        document.querySelector('.wheel-mask').classList.remove('active');
    }, 4000);
}

// --- INITIALISATION ---
window.addEventListener('load', () => {
    setTimeout(() => {
        const loader = document.getElementById('loader');
        if(loader) loader.classList.add('loader-hidden');
    }, 1500);
    
    render();
    drawWheel();
    updateVisitorCount();
    
    // Remplir les catÃ©gories
    const categoriesContainer = document.getElementById('categories-container');
    if(categoriesContainer) {
        categoriesContainer.innerHTML = `
            <span class="category-link cursor-pointer flex justify-between items-center" onclick="render('tous')">
                Tout voir <i class="fa-solid fa-crown text-[10px] text-[#c5a059]"></i>
            </span>
            ${categories.map(c => `
                <span class="category-link cursor-pointer flex justify-between items-center" onclick="render('${c.id}')">
                    ${c.nom} <i class="fa-solid ${c.icone} text-[10px]"></i>
                </span>
            `).join('')}
        `;
    }
    
    // Attacher l'Ã©vÃ©nement de la roue
    document.getElementById('spin').addEventListener('click', lancerRoue);
    
    // Input listeners pour le bouton de validation
    document.getElementById('nom-client')?.addEventListener('input', toggleBouton);
    document.getElementById('tel-client')?.addEventListener('input', toggleBouton);
});
</script>

</body>
</html>
