<!DOCTYPE html>
<html lang="fr" translate="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LATYFA BOUTIQUE | Officiel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,900;1,900&family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root { 
            --latyfa-gold: #c5a059; --latyfa-dark: #1a1a1a; --latyfa-accent: #ff6600; 
        }
        body { font-family: 'Montserrat', sans-serif; background-color: #fcfcfc; scroll-behavior: smooth; transition: background-color 0.5s ease; }
        body.dark-theme { background-color: #121212 !important; color: #e0e0e0; }
        .dark-theme header, .dark-theme aside, .dark-theme .product-card, .dark-theme .modal > div { background-color: #1e1e1e !important; border-color: #333 !important; }
        .logo-font { font-family: 'Playfair Display', serif; }
        .ali-gradient { background: linear-gradient(90deg, var(--latyfa-gold) 0%, #e2c286 100%); animation: pulse-gold 2s infinite; }
        @keyframes pulse-gold { 0% { box-shadow: 0 0 0 0 rgba(197, 160, 89, 0.4); } 70% { box-shadow: 0 0 0 10px rgba(197, 160, 89, 0); } 100% { box-shadow: 0 0 0 0 rgba(197, 160, 89, 0); } }
        .product-card { background: white; border-radius: 8px; transition: 0.2s; cursor: pointer; border: 1px solid transparent; }
        .product-card:hover { border-color: var(--latyfa-gold); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .modal { display: none; position: fixed; z-index: 1000; inset: 0; background: rgba(0,0,0,0.5); overflow-y: auto; padding: 20px; }
        .modal.active { display: block; }
        .wheel-mask { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 2000; align-items: center; justify-content: center; backdrop-filter: blur(8px); }
        .wheel-mask.active { display: flex; }
        #canvas { border-radius: 50%; border: 8px solid #1a1a1a; box-shadow: 0 0 20px rgba(197, 160, 89, 0.5); }
        @keyframes marquee { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }
        .animate-marquee { display: inline-block; animation: marquee 25s linear infinite; }
        .loader-hidden { opacity: 0; pointer-events: none; }
        @keyframes loading { 0% { transform: translateX(-100%); } 100% { transform: translateX(100%); } }
        .thumb-active { border-color: var(--latyfa-gold) !important; transform: scale(1.05); }
        .category-link { font-size: 11px; font-weight: 700; color: #555; transition: 0.3s; border-bottom: 1px solid #f0f0f0; padding-bottom: 8px; }
        .category-link:hover { color: var(--latyfa-gold); padding-left: 5px; }
    </style>
</head>
<body>

<div id="loader" class="fixed inset-0 bg-[#1a1a1a] z-[3000] flex flex-col items-center justify-center transition-opacity duration-700">
    <img src="https://i.postimg.cc/qMqtFGM2/1770342273452.png" class="h-24 w-24 rounded-full border-2 border-[#c5a059] animate-pulse">
    <span class="logo-font text-2xl text-[#c5a059] italic mt-4">LATYFA SHOP</span>
    <div class="w-32 h-[1px] bg-gray-800 mt-3 relative overflow-hidden">
        <div class="absolute inset-0 bg-[#c5a059] animate-[loading_1.5s_linear_infinite]"></div>
    </div>
</div>

<div id="toast" class="fixed top-20 left-1/2 -translate-x-1/2 bg-black/90 text-[#c5a059] px-6 py-3 rounded-full text-[10px] font-bold z-[2000] opacity-0 transition-opacity">
    ‚ú® PRODUIT AJOUT√â AU PANIER
</div>

<div class="bg-[#1a1a1a] text-[#c5a059] text-center py-2.5 text-[10px] font-bold uppercase tracking-widest">
    ‚ú® Promo St Valentin -20% d√®s 20.000 F : <span id="countdown" class="text-white ml-1">--:--:--</span> ‚ú®
</div>

<header class="bg-white shadow-sm sticky top-0 z-50">
    <div class="container mx-auto px-4 py-3 flex items-center justify-between">
        <div class="flex items-center gap-2">
            <img src="https://i.postimg.cc/qMqtFGM2/1770342273452.png" class="h-10 w-10 rounded-full">
            <span class="text-2xl font-black italic logo-font text-[#c5a059]">LATYFA SHOP</span>
        </div>
        <div class="flex gap-6 items-center">
            <button onclick="toggleDarkMode()" id="dark-mode-btn" class="h-8 w-8 rounded-full bg-gray-100 flex items-center justify-center"><i class="fa-solid fa-moon"></i></button>
            <div onclick="ouvrirPanier()" class="relative cursor-pointer text-center">
                <i class="fa-solid fa-cart-shopping text-gray-600"></i>
                <span id="cart-count" class="absolute -top-2 -right-2 bg-[#ff6600] text-white text-[10px] rounded-full px-1.5 font-bold">0</span>
                <p class="text-[9px] font-bold uppercase">Panier</p>
            </div>
        </div>
    </div>
</header>

<section class="relative h-[350px] bg-black overflow-hidden">
    <img src="https://images.unsplash.com/photo-1441986300917-64674bd600d8?w=1200" class="w-full h-full object-cover opacity-60">
    <div class="absolute inset-0 flex flex-col items-center justify-center text-center">
        <h1 class="text-white text-4xl md:text-6xl font-black italic uppercase">La Boutique du 225</h1>
        <a href="#collection" class="mt-8 bg-[#ff6600] text-white px-10 py-4 rounded-full font-black text-xs uppercase shadow-lg">D√©couvrir</a>
    </div>
</section>

<div id="collection" class="container mx-auto px-4 py-12 flex flex-col md:flex-row gap-8">
    <aside class="w-full md:w-64 bg-white rounded-xl p-6 shadow-sm h-fit sticky top-24 border border-gray-100">
        <h3 class="logo-font border-b-2 border-[#c5a059] pb-3 mb-6 text-center text-sm uppercase font-black">Nos Univers</h3>
        <div class="flex flex-col gap-5" id="sidebar-cats">
            </div>
    </aside>
    <main class="flex-1">
        <div class="mb-6"><input type="text" id="search-input" oninput="rechercherProduit()" placeholder="Rechercher un article..." class="w-full bg-gray-100 rounded-full py-3 px-6 text-xs outline-none focus:ring-2 focus:ring-[#c5a059]"></div>
        <div class="grid grid-cols-2 lg:grid-cols-3 gap-6" id="product-grid"></div>
    </main>
</div>

<div id="productDetailModal" class="modal">
    <div class="max-w-4xl mx-auto bg-white p-8 rounded-2xl relative">
        <button onclick="document.getElementById('productDetailModal').classList.remove('active')" class="absolute top-4 right-4 text-2xl">&times;</button>
        <div class="flex flex-col md:flex-row gap-8">
            <div class="md:w-1/2">
                <div id="media-main-container">
                    <img id="main-detail-img" src="" class="w-full h-80 object-cover rounded-xl border">
                </div>
                <div id="thumbnails" class="flex gap-2 mt-4 overflow-x-auto"></div>
            </div>
            <div class="md:w-1/2">
                <h2 id="detail-name" class="text-2xl font-black uppercase italic"></h2>
                <p id="detail-price" class="text-[#ff6600] font-black text-2xl mt-2"></p>
                <p id="detail-desc" class="text-xs text-gray-600 my-4 leading-relaxed"></p>
                
                <div id="size-area" class="mb-4 hidden">
                    <label class="text-[10px] font-black uppercase text-gray-400">Taille / Pointure</label>
                    <select id="select-size" class="w-full border p-2 rounded-lg mt-1 text-sm bg-gray-50"></select>
                </div>
                
                <button onclick="ajouterDepuisDetail()" class="w-full ali-gradient text-white py-4 rounded-xl font-black uppercase text-[11px] shadow-lg">Ajouter au panier</button>
            </div>
        </div>
    </div>
</div>

<div id="cartModal" class="modal">
    <div class="max-w-md mx-auto bg-white rounded-2xl p-6 mt-10 shadow-2xl">
        <div class="flex justify-between items-center mb-6 border-b pb-4">
            <h2 class="text-lg font-black uppercase text-[#c5a059]">Mon Panier</h2>
            <button onclick="viderPanier()" class="text-[10px] text-red-500 font-bold uppercase">Vider</button>
        </div>
        <div id="cart-items" class="space-y-4 mb-6"></div>
        <div id="checkout-form" class="space-y-4" style="display:none;">
            <input type="text" id="nom-client" placeholder="NOM COMPLET *" class="w-full border p-3 rounded-lg text-sm">
            <input type="tel" id="tel-client" placeholder="WHATSAPP *" class="w-full border p-3 rounded-lg text-sm">
            <select id="zone-livraison" onchange="majResume()" class="w-full border p-3 rounded-lg text-sm font-bold">
                <option value="">-- ZONE DE LIVRAISON --</option>
                <option value="abidjan_nord">Abidjan Nord (1.500 F)</option>
                <option value="abidjan_sud">Abidjan Sud (2.000 F)</option>
                <option value="interieur">Int√©rieur pays (3.000 F)</option>
                <option value="bouake">Retrait Boutique (Gratuit)</option>
            </select>
            <div id="resume-final" class="bg-gray-50 p-4 rounded-xl text-[10px] uppercase font-bold space-y-2"></div>
            <div class="text-xl font-black flex justify-between p-3 border-2 border-black rounded-xl">
                <span>TOTAL :</span> <span id="total-display">0</span> F
            </div>
            <button id="btn-final" onclick="validerCommande()" class="w-full bg-gray-300 text-white py-4 rounded-full font-black uppercase">Commander via WhatsApp</button>
        </div>
        <button onclick="document.getElementById('cartModal').classList.remove('active')" class="w-full mt-4 text-[10px] font-bold text-gray-400 underline uppercase">Continuer mes achats</button>
    </div>
</div>

<div class="wheel-mask">
    <div class="bg-white p-8 rounded-3xl text-center relative max-w-sm w-full">
        <button onclick="document.querySelector('.wheel-mask').classList.remove('active')" class="absolute top-4 right-4 text-2xl font-black">&times;</button>
        <h3 class="logo-font text-xl font-black uppercase mb-4">Latyfa Lucky Wheel</h3>
        <p id="wheel-msg" class="text-[10px] font-bold mb-4"></p>
        <canvas id="canvas" width="300" height="300"></canvas>
        <button id="spin" class="w-full bg-black text-white py-4 rounded-full font-black mt-6">TENTER MA CHANCE</button>
    </div>
</div>

<button onclick="document.querySelector('.wheel-mask').classList.add('active')" class="fixed bottom-24 right-6 h-14 w-14 bg-black text-white rounded-full shadow-2xl z-40 animate-bounce flex items-center justify-center border-2 border-[#c5a059]">
    <i class="fa-solid fa-gift text-[#c5a059] text-2xl"></i>
</button>

<footer class="bg-white border-t py-12 text-center">
    <div class="container mx-auto px-4">
        <img src="https://i.postimg.cc/qMqtFGM2/1770342273452.png" class="h-12 w-12 mx-auto rounded-full mb-4">
        <p class="text-[10px] font-bold text-gray-400 uppercase tracking-widest">¬© 2026 LATYFA BUSINESS | Abidjan, C√¥te d'Ivoire</p>
        <div id="visitor-count" class="mt-4 text-[12px] font-black text-[#c5a059]">0000</div>
    </div>
</footer>

<div id="adminModal" class="modal bg-gray-100">
    <div class="max-w-2xl mx-auto p-6 bg-white rounded-2xl mt-10 shadow-xl overflow-y-auto h-[80vh]">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-xl font-black uppercase italic">Espace Admin</h2>
            <button onclick="document.getElementById('adminModal').classList.remove('active')" class="text-2xl">&times;</button>
        </div>
        <div class="grid grid-cols-2 gap-4 mb-6 text-center">
            <div class="bg-blue-50 p-4 rounded-xl"><p class="text-[9px] font-black uppercase">Chiffre d'affaires</p><div id="stat-ca" class="text-xl font-black text-blue-600">0 F</div></div>
            <div class="bg-green-50 p-4 rounded-xl"><p class="text-[9px] font-black uppercase">Commandes</p><div id="stat-nb" class="text-xl font-black text-green-600">0</div></div>
        </div>
        <div class="space-y-4">
            <input type="text" id="adm-name" placeholder="Nom du produit" class="w-full border p-3 rounded-lg">
            <input type="number" id="adm-price" placeholder="Prix" class="w-full border p-3 rounded-lg">
            <select id="adm-cat" class="w-full border p-3 rounded-lg"></select>
            <textarea id="adm-img" placeholder="Liens images (s√©par√©s par virgule)" class="w-full border p-3 rounded-lg"></textarea>
            <button onclick="ajouterProduitAdmin()" class="w-full bg-black text-white py-4 rounded-xl font-black uppercase">Mettre en ligne</button>
        </div>
        <div id="admin-list" class="mt-8 space-y-2"></div>
        <div class="mt-8 pt-6 border-t">
            <button onclick="sauvegarderHistorique()" class="w-full bg-blue-600 text-white py-3 rounded-xl font-black text-[10px] uppercase mb-2">Exporter Excel</button>
            <button onclick="toggleHistorique()" class="w-full bg-gray-200 py-3 rounded-xl font-black text-[10px] uppercase">Voir Historique</button>
            <div id="historique-zone" class="hidden mt-4 space-y-2"></div>
        </div>
    </div>
</div>

<div onclick="ouvrirAdmin()" class="fixed bottom-2 left-2 w-10 h-10 cursor-pointer opacity-0 z-[100]">ADM</div>

<audio id="wheel-sound" src="https://assets.mixkit.co/active_storage/sfx/483/483-preview.mp3" preload="auto"></audio>
<audio id="victory-sound" src="https://assets.mixkit.co/active_storage/sfx/1435/1435-preview.mp3" preload="auto"></audio>
<audio id="cart-sound" src="https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3" preload="auto"></audio>

<script>
    // --- INITIALISATION ---
    let products = JSON.parse(localStorage.getItem('latyfa_db')) || [
        { id: 1, cat: "sac", name: "Sac Prestige Latyfa", price: 45000, images: ["https://images.unsplash.com/photo-1584917865442-de89df76afd3?w=500"], enStock: true, description: "√âl√©gance Signature Latyfa." },
        { id: 2, cat: "bijoux", name: "Collier Perle Royale", price: 25000, images: ["https://images.unsplash.com/photo-1515562141207-7a18b5ce7142?w=500"], enStock: true, description: "Finition Or 24K." }
    ];
    let categories = JSON.parse(localStorage.getItem('latyfa_categories')) || [
        { id: 'bijoux', nom: 'Bijoux', icone: 'fa-gem' },
        { id: 'vetements', nom: 'V√™tements', icone: 'fa-shirt' },
        { id: 'chaussures', nom: 'Chaussures', icone: 'fa-shoe-prints' },
        { id: 'sac', nom: 'Sacs', icone: 'fa-bag-shopping' },
        { id: 'parfum', nom: 'Parfums', icone: 'fa-spray-can-sparkles' }
    ];
    let cart = JSON.parse(localStorage.getItem('latyfa_cart')) || [];
    let currentProduct = null;
    let remiseCodePromo = 0;
    const prizes = ["-5%", "REESSAYER", "-10%", "CADEAU", "-15%", "REESSAYER", "LIVRAISON", "REESSAYER"];

    const tarifsLivraison = {
        "abidjan_nord": { nom: "Abidjan Nord", prix: 1500 },
        "abidjan_sud": { nom: "Abidjan Sud", prix: 2000 },
        "interieur": { nom: "Int√©rieur CI", prix: 3000 },
        "bouake": { nom: "Retrait Boutique", prix: 0 }
    };

    // --- FONCTIONS CORE ---
    function render(filter = 'tous') {
        const grid = document.getElementById('product-grid');
        grid.innerHTML = products.filter(p => filter === 'tous' || p.cat === filter).map(p => `
            <div class="product-card p-3 relative ${!p.enStock ? 'opacity-50' : ''}" onclick="${p.enStock ? 'voirDetails('+p.id+')' : ''}">
                <img src="${p.images[0]}" class="h-44 w-full object-cover rounded mb-3 border">
                <h3 class="text-[11px] font-bold uppercase h-8 line-clamp-2">${p.name}</h3>
                <div class="text-[#c5a059] font-black text-lg mt-2">${p.price.toLocaleString()} F</div>
                <div class="bg-gray-50 text-center py-2 mt-4 rounded text-[9px] font-bold uppercase">${p.enStock ? 'Voir' : '√âpuis√©'}</div>
            </div>`).join('');
        document.getElementById('cart-count').innerText = cart.reduce((a, b) => a + b.qty, 0);
    }

    function refreshCategoriesUI() {
        const sidebar = document.getElementById('sidebar-cats');
        const admSelect = document.getElementById('adm-cat');
        let html = `<span class="category-link cursor-pointer flex justify-between items-center" onclick="render('tous')">Tout voir <i class="fa-solid fa-crown text-[#c5a059]"></i></span>`;
        html += categories.map(cat => `<span class="category-link cursor-pointer flex justify-between items-center" onclick="render('${cat.id}')">${cat.nom} <i class="fa-solid ${cat.icone}"></i></span>`).join('');
        sidebar.innerHTML = html;
        admSelect.innerHTML = categories.map(cat => `<option value="${cat.id}">${cat.nom}</option>`).join('');
    }

    function voirDetails(id) {
        const p = products.find(x => x.id === id);
        if(!p) return;
        currentProduct = p;
        document.getElementById('detail-name').innerText = p.name;
        document.getElementById('detail-price').innerText = p.price.toLocaleString() + " F";
        document.getElementById('detail-desc').innerText = p.description;
        document.getElementById('main-detail-img').src = p.images[0];
        
        const thumbs = document.getElementById('thumbnails');
        thumbs.innerHTML = p.images.map((img, i) => `<img src="${img}" onclick="document.getElementById('main-detail-img').src='${img}'" class="h-16 w-16 object-cover rounded cursor-pointer border ${i===0?'thumb-active':''}">`).join('');
        
        document.getElementById('productDetailModal').classList.add('active');
    }

    function ajouterDepuisDetail() {
        const item = { ...currentProduct, qty: 1, label: currentProduct.name };
        const index = cart.findIndex(x => x.id === item.id);
        if(index > -1) cart[index].qty++; else cart.push(item);
        
        document.getElementById('cart-sound').play();
        localStorage.setItem('latyfa_cart', JSON.stringify(cart));
        render();
        document.getElementById('productDetailModal').classList.remove('active');
        const toast = document.getElementById('toast');
        toast.style.opacity = "1"; setTimeout(() => toast.style.opacity = "0", 2000);
    }

    // --- PANIER & COMMANDE ---
    function ouvrirPanier() {
        const itemsDiv = document.getElementById('cart-items');
        const form = document.getElementById('checkout-form');
        document.getElementById('cartModal').classList.add('active');
        
        if(cart.length === 0) {
            itemsDiv.innerHTML = "<p class='text-center py-10 text-xs font-bold text-gray-400'>PANIER VIDE</p>";
            form.style.display = "none";
        } else {
            form.style.display = "block";
            itemsDiv.innerHTML = cart.map(item => `
                <div class="flex justify-between items-center text-[10px] font-bold uppercase">
                    <div class="flex-1">${item.label}</div>
                    <div class="flex gap-2">
                        <button onclick="modifierQty(${item.id},-1)" class="bg-gray-100 px-2">-</button>
                        <span>${item.qty}</span>
                        <button onclick="modifierQty(${item.id},1)" class="bg-gray-100 px-2">+</button>
                    </div>
                </div>`).join('');
            majResume();
        }
    }

    function modifierQty(id, d) {
        const i = cart.find(x => x.id === id);
        if(i) { i.qty += d; if(i.qty < 1) cart = cart.filter(x => x.id !== id); }
        localStorage.setItem('latyfa_cart', JSON.stringify(cart));
        ouvrirPanier(); render();
    }

    function majResume() {
        const zone = document.getElementById('zone-livraison').value;
        const totalArticles = cart.reduce((s, i) => s + (i.price * i.qty), 0);
        let livraison = zone ? tarifsLivraison[zone].prix : 0;
        
        let promoValentin = (totalArticles >= 20000) ? totalArticles * 0.20 : 0;
        let totalFinal = totalArticles + livraison - promoValentin;
        
        document.getElementById('resume-final').innerHTML = `
            <div class="flex justify-between"><span>Articles:</span> <span>${totalArticles} F</span></div>
            <div class="flex justify-between"><span>Livraison:</span> <span>+${livraison} F</span></div>
            ${promoValentin > 0 ? `<div class="flex justify-between text-green-600"><span>Promo Valentin:</span> <span>-${promoValentin} F</span></div>` : ''}
        `;
        document.getElementById('total-display').innerText = Math.round(totalFinal).toLocaleString();
        
        const btn = document.getElementById('btn-final');
        if(zone && document.getElementById('nom-client').value.trim()) {
            btn.classList.replace('bg-gray-300', 'ali-gradient');
            btn.disabled = false;
        }
    }

    function validerCommande() {
        const nom = document.getElementById('nom-client').value;
        const total = document.getElementById('total-display').innerText;
        let list = cart.map(i => `‚Ä¢ ${i.label} (x${i.qty})`).join('\n');
        let msg = `‚ú® *COMMANDE LATYFA SHOP*\n\nüë§ CLIENT: ${nom}\nüìù ARTICLES:\n${list}\n\nüí∞ TOTAL: ${total} F`;
        
        // Historique
        let historique = JSON.parse(localStorage.getItem('latyfa_historique')) || [];
        historique.unshift({ date: new Date().toLocaleString(), client: nom, total: total, articles: list });
        localStorage.setItem('latyfa_historique', JSON.stringify(historique));
        
        window.open("https://wa.me/2250709002881?text=" + encodeURIComponent(msg));
    }

    // --- ROUE ---
    const ctx = document.getElementById('canvas').getContext('2d');
    function drawWheel() {
        const arc = 2 * Math.PI / prizes.length;
        for (let i = 0; i < prizes.length; i++) {
            ctx.beginPath(); ctx.fillStyle = i % 2 === 0 ? "#c5a059" : "#000";
            ctx.moveTo(150, 150); ctx.arc(150, 150, 145, i * arc, (i + 1) * arc); ctx.fill();
            ctx.save(); ctx.fillStyle = "white"; ctx.translate(150, 150); ctx.rotate(i * arc + arc/2);
            ctx.font = "bold 10px Montserrat"; ctx.textAlign = "right"; ctx.fillText(prizes[i], 130, 5); ctx.restore();
        }
    }

    document.getElementById('spin').onclick = function() {
        const btn = this; btn.disabled = true;
        document.getElementById('wheel-sound').play();
        const rand = Math.floor(Math.random() * 360) + 3600;
        document.getElementById('canvas').style.transition = "4s cubic-bezier(0.15, 0, 0.15, 1)";
        document.getElementById('canvas').style.transform = `rotate(${rand}deg)`;
        
        setTimeout(() => {
            confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
            document.getElementById('victory-sound').play();
            alert("F√âLICITATIONS ! Tentez d'utiliser votre gain lors de votre commande WhatsApp.");
            btn.disabled = false;
        }, 4000);
    };

    // --- ADMIN ---
    function ouvrirAdmin() {
        if(prompt("Code d'acc√®s :") === (localStorage.getItem('latyfa_admin_code') || "2026")) {
            document.getElementById('adminModal').classList.add('active');
            refreshAdminList();
            majStats();
        }
    }

    function ajouterProduitAdmin() {
        const name = document.getElementById('adm-name').value;
        const price = document.getElementById('adm-price').value;
        const images = document.getElementById('adm-img').value.split(',').map(s => s.trim());
        if(!name || !price) return;
        
        products.push({ id: Date.now(), name, price: parseInt(price), images, cat: document.getElementById('adm-cat').value, enStock: true });
        localStorage.setItem('latyfa_db', JSON.stringify(products));
        render(); refreshAdminList();
    }

    function refreshAdminList() {
        document.getElementById('admin-list').innerHTML = products.map(p => `
            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                <span class="text-[10px] font-bold">${p.name}</span>
                <button onclick="supprimerProduit(${p.id})" class="text-red-500"><i class="fa-solid fa-trash"></i></button>
            </div>`).join('');
    }

    function supprimerProduit(id) {
        if(confirm("Supprimer ?")) {
            products = products.filter(p => p.id !== id);
            localStorage.setItem('latyfa_db', JSON.stringify(products));
            render(); refreshAdminList();
        }
    }

    function majStats() {
        const hist = JSON.parse(localStorage.getItem('latyfa_historique')) || [];
        document.getElementById('stat-nb').innerText = hist.length;
        let ca = hist.reduce((s, c) => s + parseInt(c.total.replace(/\s/g, '')), 0);
        document.getElementById('stat-ca').innerText = ca.toLocaleString() + " F";
    }

    function toggleHistorique() {
        const zone = document.getElementById('historique-zone');
        zone.classList.toggle('hidden');
        const hist = JSON.parse(localStorage.getItem('latyfa_historique')) || [];
        zone.innerHTML = hist.map(h => `<div class="p-2 border-b text-[9px]"><b>${h.date}</b> - ${h.client} - ${h.total} F</div>`).join('');
    }

    function toggleDarkMode() {
        document.body.classList.toggle('dark-theme');
        const isDark = document.body.classList.contains('dark-theme');
        document.getElementById('dark-mode-btn').innerHTML = isDark ? '<i class="fa-solid fa-sun"></i>' : '<i class="fa-solid fa-moon"></i>';
    }

    function rechercherProduit() {
        const term = document.getElementById('search-input').value.toLowerCase();
        const filtered = products.filter(p => p.name.toLowerCase().includes(term));
        const grid = document.getElementById('product-grid');
        grid.innerHTML = filtered.map(p => `<div class="product-card p-3" onclick="voirDetails(${p.id})">...</div>`).join('');
        render(); // On r√©utilise le render de base si besoin
    }

    // --- RUN ---
    window.onload = () => {
        setTimeout(() => document.getElementById('loader').classList.add('loader-hidden'), 1500);
        render();
        refreshCategoriesUI();
        drawWheel();
        let count = parseInt(localStorage.getItem('latyfa_visitors') || "1250") + 1;
        localStorage.setItem('latyfa_visitors', count);
        document.getElementById('visitor-count').innerText = count.toLocaleString();
    };

    setInterval(() => {
        const diff = new Date("Feb 14, 2026 00:00:00").getTime() - new Date().getTime();
        if(diff <= 0) return document.getElementById('countdown').innerText = "EN COURS";
        const h = Math.floor(diff/3600000), m = Math.floor((diff%3600000)/60000), s = Math.floor((diff%60000)/1000);
        document.getElementById('countdown').innerText = `${h}h ${m}m ${s}s`;
    }, 1000);
</script>
</body>
</html>
