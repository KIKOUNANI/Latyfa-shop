<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LATYFA BOUTIQUE - Test 4</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,900;1,900&family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1"></script>
    <style>
        :root { 
            --latyfa-gold: #c5a059;   
            --latyfa-dark: #1a1a1a;   
            --latyfa-accent: #ff6600; 
        }
        
        body { 
            background-color: #fcfcfc; 
            font-family: 'Montserrat', sans-serif; 
            margin: 0; 
        }
        
        .logo-font { font-family: 'Playfair Display', serif; color: var(--latyfa-gold) !important; }
        
        .test-section {
            border: 2px solid var(--latyfa-gold);
            padding: 20px;
            margin: 20px;
            border-radius: 10px;
        }
        
        .treasure-section {
            background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
            border-radius: 24px;
            padding: 24px;
            color: white;
            margin: 20px;
        }
        
        .mission-card {
            background: rgba(255,255,255,0.05);
            border-radius: 16px;
            padding: 16px;
            text-align: center;
            margin: 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="bg-[#1a1a1a] text-[#c5a059] text-center py-2.5 text-[10px] font-bold">
        TEST 4 - Chasse au tr√©sor ajout√©e
    </div>

    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3">
            <span class="text-xl font-black italic logo-font">LATYFA SHOP</span>
        </div>
    </header>

    <!-- SECTION DE TEST -->
    <div class="test-section">
        <h2 class="text-xl font-bold text-[#c5a059] mb-4">‚úÖ √âTAPE 4 - CHASSE AU TR√âSOR</h2>
        
        <div class="mb-4 p-3 bg-gray-50 rounded">
            <p class="font-bold mb-2">Statut du chargement :</p>
            <div id="status" class="text-sm"></div>
        </div>

        <!-- Section chasse au tr√©sor simplifi√©e -->
        <div class="treasure-section">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold">CHASSE AU TR√âSOR</h3>
                <span id="treasurePoints" class="bg-[#c5a059] text-black px-4 py-2 rounded-full">0</span>
            </div>
            
            <div class="missions-grid" id="dailyMissions">
                <!-- Les missions appara√Ætront ici -->
            </div>
            
            <button onclick="testTreasure()" class="bg-[#c5a059] text-black px-4 py-2 rounded mt-4">
                Tester l'ajout de points
            </button>
        </div>
    </div>

    <script>
        console.log('üöÄ √âTAPE 4 - Chargement...');
        
        // ==================== SYST√àME DE CHASSE AU TR√âSOR ====================
        const treasureLevels = [
            { name: 'Bronze', points: 0, discount: 5 },
            { name: 'Argent', points: 500, discount: 10 },
            { name: 'Or', points: 1500, discount: 15 },
            { name: 'Platine', points: 3000, discount: 20 },
            { name: 'Diamant', points: 5000, discount: 25 }
        ];

        const dailyMissions = [
            { id: 'visit', name: 'Visite du jour', emoji: 'üëã', points: 10, action: 'Se connecter' },
            { id: 'share', name: 'Partager', emoji: 'üì§', points: 20, action: 'Partager' },
            { id: 'wishlist', name: 'Favoris', emoji: '‚ù§Ô∏è', points: 15, action: 'Ajouter 3 favoris' },
            { id: 'review', name: 'Avis', emoji: '‚≠ê', points: 30, action: 'Donner son avis' }
        ];

        const treasureRewards = [
            { name: 'Bracelet Myst√®re', emoji: 'üìø', proba: 30 },
            { name: 'Code -15%', emoji: 'üè∑Ô∏è', proba: 25 },
            { name: '100 points', emoji: '‚≠ê', proba: 20 },
            { name: 'Livraison gratuite', emoji: 'üì¶', proba: 15 },
            { name: 'Collier surprise', emoji: 'üíé', proba: 10 }
        ];

        // Variables globales
        let userTreasure = {
            points: 0,
            level: 'Bronze',
            daily: {}
        };

        // Fonctions
        function initTreasure() {
            console.log('Initialisation de la chasse au tr√©sor...');
            try {
                const saved = localStorage.getItem('latyfa_treasure');
                if (saved) {
                    userTreasure = JSON.parse(saved);
                }
                updateTreasureUI();
                document.getElementById('status').innerHTML += '<p class="text-green-600">‚úì Chasse au tr√©sor initialis√©e</p>';
            } catch (e) {
                console.error('Erreur initTreasure:', e);
                document.getElementById('status').innerHTML += '<p class="text-red-600">‚ùå Erreur initTreasure</p>';
            }
        }

        function updateTreasureUI() {
            document.getElementById('treasurePoints').innerText = userTreasure.points;
            
            const container = document.getElementById('dailyMissions');
            if (container) {
                container.innerHTML = dailyMissions.map(mission => `
                    <div class="mission-card" onclick="completeMission('${mission.id}')">
                        <div class="text-3xl mb-2">${mission.emoji}</div>
                        <div class="font-bold">${mission.name}</div>
                        <div class="text-[#c5a059]">+${mission.points}</div>
                        <div class="text-xs mt-2">${mission.action}</div>
                    </div>
                `).join('');
            }
        }

        function completeMission(missionId) {
            const mission = dailyMissions.find(m => m.id === missionId);
            if (mission) {
                userTreasure.points += mission.points;
                localStorage.setItem('latyfa_treasure', JSON.stringify(userTreasure));
                updateTreasureUI();
                alert(`‚ú® +${mission.points} points !`);
                confetti({ particleCount: 50, spread: 50 });
            }
        }

        function testTreasure() {
            userTreasure.points += 100;
            localStorage.setItem('latyfa_treasure', JSON.stringify(userTreasure));
            updateTreasureUI();
            alert('‚ú® 100 points ajout√©s !');
            confetti({ particleCount: 100, spread: 70 });
        }

        // Initialisation
        try {
            document.getElementById('status').innerHTML = '<p class="text-green-600">‚úì Variables charg√©es</p>';
            initTreasure();
            console.log('‚úÖ √âTAPE 4 - Termin√© avec succ√®s');
        } catch (error) {
            console.error('‚ùå Erreur:', error);
            document.getElementById('status').innerHTML += `<p class="text-red-600">‚ùå Erreur: ${error.message}</p>`;
        }
    </script>
</body>
</html>
