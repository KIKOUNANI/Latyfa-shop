<!DOCTYPE html>
<html lang="fr" translate="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LATYYA | Maison de Luxe</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Montserrat', sans-serif; background-color: #ffffff; }
        .luxury-font { font-family: 'Playfair Display', serif; }
        .btn-black { background-color: #1a1a1a; color: white; transition: 0.3s; }
        .btn-black:hover { background-color: #c49a6c; }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.98); overflow-y: auto; }
        .modal.active { display: block; }
        #receipt-content { padding: 40px; background: white; width: 500px; margin: auto; border: 1px solid #eee; }
    </style>
</head>
<body>

    <header class="border-b border-gray-100 sticky top-0 bg-white/90 backdrop-blur-md z-50 px-6 py-4 flex justify-between items-center">
        <h1 class="luxury-font text-2xl tracking-[0.3em] uppercase">Latyya</h1>
        <div onclick="ouvrirPanier()" class="cursor-pointer uppercase text-[10px] tracking-widest font-bold">
            Panier <span id="cart-count" class="text-[#c49a6c]">(0)</span>
        </div>
    </header>

    <main class="container mx-auto px-4 py-12">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-12" id="product-grid"></div>
    </main>

    <div id="cartModal" class="modal">
        <div class="max-w-2xl mx-auto py-20 px-6">
            <h2 class="luxury-font text-3xl text-center mb-10 italic">Votre Sélection</h2>
            
            <div id="cart-items" class="space-y-4 mb-10"></div>

            <div id="checkout-form" style="display:none;" class="space-y-6">
                <div class="border-t border-b py-6 flex justify-between font-bold text-xl">
                    <span>TOTAL</span>
                    <span><span id="total">0</span> F CFA</span>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-[10px] tracking-widest">
                    <input type="text" id="nom" placeholder="NOM COMPLET" class="border-b p-3 outline-none focus:border-[#c49a6c]">
                    <input type="text" id="adresse" placeholder="VILLE & QUARTIER" class="border-b p-3 outline-none focus:border-[#c49a6c]">
                </div>

                <div class="space-y-3 pt-6">
                    <p class="text-[10px] font-bold tracking-widest text-gray-400">MODE DE PAIEMENT</p>
                    <label class="flex items-center gap-3 p-4 border rounded-xl cursor-pointer hover:border-black">
                        <input type="radio" name="pay" value="WAVE" checked> <span class="text-sm">WAVE (Payer maintenant)</span>
                    </label>
                    <label class="flex items-center gap-3 p-4 border rounded-xl cursor-pointer hover:border-black">
                        <input type="radio" name="pay" value="OM"> <span class="text-sm">ORANGE MONEY (Transfert 0709002881)</span>
                    </label>
                    <label class="flex items-center gap-3 p-4 border rounded-xl cursor-pointer hover:border-black">
                        <input type="radio" name="pay" value="CASH"> <span class="text-sm">CASH À LA LIVRAISON</span>
                    </label>
                </div>

                <button onclick="traiterCommande()" class="w-full btn-black py-5 text-[10px] font-bold uppercase tracking-widest mt-8">Confirmer la Commande</button>
            </div>
            
            <button onclick="fermerPanier()" class="w-full mt-8 text-gray-400 text-[10px] uppercase tracking-[0.3em] text-center">Retour à la boutique</button>
        </div>
    </div>

    <div style="display:none">
        <div id="receipt-template">
            <h1 style="text-align:center; font-family:serif;">REÇU LATYYA SHOP</h1>
            <hr>
            <p><strong>Client:</strong> <span id="r-nom"></span></p>
            <p><strong>Lieu:</strong> <span id="r-adresse"></span></p>
            <p><strong>Paiement:</strong> <span id="r-pay"></span></p>
            <hr>
            <div id="r-items"></div>
            <hr>
            <h3 style="text-align:right">TOTAL: <span id="r-total"></span> F CFA</h3>
            <p style="font-size:10px; text-align:center; margin-top:50px;">Merci pour votre confiance. Maison Latyya.</p>
        </div>
    </div>

    <script>
        const products = [
            { name: "Sac Signature", price: 45000, img: "https://images.unsplash.com/photo-1584917865442-de89df76afd3?w=800" },
            { name: "Escarpins Luxe", price: 35000, img: "https://images.unsplash.com/photo-1535043934128-cf0b28d52f95?w=800" }
        ];

        let cart = [];

        function render() {
            const g = document.getElementById('product-grid');
            g.innerHTML = '';
            products.forEach((p, i) => {
                g.innerHTML += `
                    <div class="group cursor-pointer" onclick="ajouterAuPanier(${i})">
                        <div class="aspect-[3/4] overflow-hidden bg-gray-50 mb-4">
                            <img src="${p.img}" class="w-full h-full object-cover group-hover:scale-105 transition duration-500">
                        </div>
                        <h3 class="text-[10px] tracking-widest uppercase mb-1">${p.name}</h3>
                        <p class="font-bold text-sm text-gray-500">${p.price.toLocaleString()} F</p>
                    </div>`;
            });
        }

        function ajouterAuPanier(i) {
            cart.push(products[i]);
            document.getElementById('cart-count').innerText = `(${cart.length})`;
            alert("Ajouté à votre sélection.");
        }

        function ouvrirPanier() {
            const modal = document.getElementById('cartModal');
            const list = document.getElementById('cart-items');
            const form = document.getElementById('checkout-form');
            modal.classList.add('active');
            if(cart.length === 0) {
                list.innerHTML = "<p class='text-center py-20 text-gray-400 uppercase text-[10px] tracking-[0.3em]'>Sélection vide</p>";
                form.style.display = "none";
            } else {
                list.innerHTML = '';
                let t = 0;
                cart.forEach(item => {
                    list.innerHTML += `<div class="flex justify-between border-b pb-2 text-sm uppercase italic"><span>${item.name}</span><span>${item.price.toLocaleString()} F</span></div>`;
                    t += item.price;
                });
                document.getElementById('total').innerText = t.toLocaleString();
                form.style.display = "block";
            }
        }

        function fermerPanier() { document.getElementById('cartModal').classList.remove('active'); }

        async function traiterCommande() {
            const nom = document.getElementById('nom').value;
            const adresse = document.getElementById('adresse').value;
            const paiement = document.querySelector('input[name="pay"]:checked').value;
            const total = document.getElementById('total').innerText;

            if(!nom || !adresse) return alert("Veuillez remplir vos informations.");

            // 1. Remplir le template du Reçu PDF
            document.getElementById('r-nom').innerText = nom;
            document.getElementById('r-adresse').innerText = adresse;
            document.getElementById('r-pay').innerText = paiement;
            document.getElementById('r-total').innerText = total;
            let itemsHtml = "";
            cart.forEach(it => { itemsHtml += `<p>${it.name} - ${it.price} F</p>`; });
            document.getElementById('r-items').innerHTML = itemsHtml;

            // 2. Générer le PDF
            const element = document.getElementById('receipt-template');
            await html2pdf().from(element).save(`Recu_Latyya_${nom}.pdf`);

            // 3. Redirection Paiement
            let message = `*COMMANDE LATYYA SHOP*\nClient: ${nom}\nTotal: ${total} F\nPaiement: ${paiement}`;
            
            if(paiement === "WAVE") {
                alert("Vous allez être redirigé vers Wave pour le paiement.");
                window.location.href = "https://pay.wave.com/m/M_ci_C7lQKnUsMYT3/c/ci/";
            } else if(paiement === "OM") {
                alert("Merci de faire le transfert de " + total + " F au 0709002881. Envoyez la capture sur WhatsApp.");
                window.open(`https://wa.me/2250709002881?text=${encodeURIComponent(message)}`);
            } else {
                alert("Commande validée ! Paiement à la livraison.");
                window.open(`https://wa.me/2250709002881?text=${encodeURIComponent(message)}`);
            }
        }

        render();
    </script>
</body>
</html>
