<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LATYFA BOUTIQUE - FINALE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Plusieurs CDN Supabase pour garantir le chargement -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.0.0/dist/umd/supabase.min.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --latyfa-gold: #c5a059; }
        body { font-family: 'Montserrat', sans-serif; background: #fcfcfc; }
        .product-card { background: white; border-radius: 12px; padding: 15px; margin: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    </style>
</head>
<body>
    <header class="bg-white shadow-sm p-4">
        <div class="container mx-auto">
            <span class="text-2xl font-black italic text-[#c5a059]">LATYFA SHOP</span>
        </div>
    </header>

    <div class="container mx-auto p-4">
        <div id="product-grid" class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <p class="text-gray-400">Chargement...</p>
        </div>
    </div>

    <script>
        console.log('üöÄ D√©marrage...');
        
        const productGrid = document.getElementById('product-grid');
        
        // Produits par d√©faut (toujours disponibles)
        const defaultProducts = [
            { 
                id: 1, 
                name: "Sac Prestige Latyfa", 
                price: 45000, 
                images: ["https://images.unsplash.com/photo-1584917865442-de89df76afd3?w=500"],
                description: "√âl√©gance Signature Latyfa"
            },
            { 
                id: 2, 
                name: "Collier Perle Royale", 
                price: 25000, 
                images: ["https://images.unsplash.com/photo-1515562141207-7a18b5ce7142?w=500"],
                description: "Finition Or 24K"
            },
            { 
                id: 3, 
                name: "Baya Cristal √âclat", 
                price: 5000, 
                images: ["https://images.unsplash.com/photo-1611085583191-a3b130944362?w=500"],
                description: "Perles de hanche traditionnelles"
            },
            { 
                id: 4, 
                name: "Oud Mystique - 100ml", 
                price: 35000, 
                images: ["https://images.unsplash.com/photo-1541643600914-78b084683601?w=500"],
                description: "Parfum de luxe"
            },
            { 
                id: 5, 
                name: "Escarpins Gold Night", 
                price: 28000, 
                images: ["https://images.unsplash.com/photo-1543163521-1bf539c55dd2?w=500"],
                description: "Chaussures de soir√©e"
            }
        ];

        function renderProducts(products) {
            if (!products || products.length === 0) {
                productGrid.innerHTML = '<p class="text-gray-400">Aucun produit</p>';
                return;
            }
            
            productGrid.innerHTML = products.map(p => `
                <div class="product-card hover:shadow-lg transition">
                    <img src="${p.images?.[0] || 'https://via.placeholder.com/300'}" 
                         class="w-full h-48 object-cover rounded-lg mb-3"
                         onerror="this.src='https://via.placeholder.com/300'">
                    <h3 class="font-bold text-lg">${p.name || 'Produit'}</h3>
                    <p class="text-gray-600 text-sm mb-2">${p.description || ''}</p>
                    <p class="text-[#c5a059] font-black text-2xl">${p.price?.toLocaleString() || '0'} F</p>
                </div>
            `).join('');
        }

        // Fonction pour charger depuis Supabase (avec gestion d'erreur)
        async function loadFromSupabase() {
            try {
                // V√©rifier si Supabase est disponible
                if (typeof supabase === 'undefined' && typeof window.supabase === 'undefined') {
                    console.log('‚ö†Ô∏è Supabase non disponible, utilisation des produits par d√©faut');
                    return null;
                }

                const supabaseClient = supabase || window.supabase;
                
                // Vos identifiants Supabase
                const supabaseUrl = 'https://tckhslbqptjquflyfyhu.supabase.co';
                const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRja2hzbGJxcHRqcXVmbHlmeWh1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE0NjczMTEsImV4cCI6MjA4NzA0MzMxMX0.oONsuo8atmylhTNzE68NUJxm_u35jXx-xmorlnWld6w';
                
                const client = supabaseClient.createClient(supabaseUrl, supabaseAnonKey);
                
                // Tentative de chargement
                const { data, error } = await client.from('products').select('*').limit(10);
                
                if (error) {
                    console.log('‚ö†Ô∏è Erreur Supabase:', error.message);
                    return null;
                }
                
                return data;
                
            } catch (error) {
                console.log('‚ö†Ô∏è Exception Supabase:', error.message);
                return null;
            }
        }

        // Chargement principal
        (async function() {
            try {
                // Essayer de charger depuis Supabase
                const supabaseProducts = await loadFromSupabase();
                
                if (supabaseProducts && supabaseProducts.length > 0) {
                    console.log('‚úÖ Produits charg√©s depuis Supabase');
                    renderProducts(supabaseProducts);
                } else {
                    console.log('üì¶ Utilisation des produits par d√©faut');
                    renderProducts(defaultProducts);
                }
                
                // Sauvegarder dans localStorage pour la prochaine fois
                localStorage.setItem('latyfa_products', JSON.stringify(defaultProducts));
                
            } catch (error) {
                console.error('‚ùå Erreur fatale:', error);
                renderProducts(defaultProducts);
            }
        })();
    </script>
</body>
</html>
